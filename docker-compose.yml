version: '3.8'

name: comic-reader

services:
  app:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: comic-reader-app
    volumes:
      # Mount uploads directory to test OCR on actual images
      - ./src/public/uploads:/app/images:ro
      # Persist Hugging Face hub cache (manga-ocr model ~400MB)
      - ./data/models/huggingface/hub:/root/.cache/huggingface/hub
      # Persist pip cache (torch ~900MB + other packages)
      - ./data/pip-cache:/pip-cache
      # OCR input/output directories
      - ./data/ocrinput:/app/ocrinput
      - ./data/ocroutput:/app/ocroutput
    networks:
      - comic-reader-network

networks:
  comic-reader-network:
    driver: bridge
