version: '3.8'

name: comic-reader

services:
  app:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: comic-reader-app
    environment:
      # Container mode paths
      - OCR_INPUT_DIR=/app/ocrinput
      - OCR_OUTPUT_FILE=/app/ocroutput/results.txt
      - DB_DIR=/app/db
      - MANGA_DIR=/app/manga
    volumes:
      # Persist Hugging Face hub cache (manga-ocr model ~400MB)
      - ${DATA_DIR:-./data}/models/huggingface/hub:/root/.cache/huggingface/hub
      # Manga uploads directory
      - ${DATA_DIR:-./data}/manga:/app/manga
      # OCR input/output directories
      - ${DATA_DIR:-./data}/ocrinput:/app/ocrinput
      - ${DATA_DIR:-./data}/ocroutput:/app/ocroutput
      # Database directory
      - ${DATA_DIR:-./data}/db:/app/db
    networks:
      - comic-reader-network

networks:
  comic-reader-network:
    driver: bridge
